# ğŸ‰ Chat-Zinx æ•°æ®åº“æ‰©å±•éƒ¨ç½²æˆåŠŸï¼

## ğŸ“Š éƒ¨ç½²æ€»ç»“

æœ¬æ¬¡æˆåŠŸä¸º Chat-Zinx èŠå¤©ç³»ç»Ÿå®ç°äº†å®Œæ•´çš„**æ•°æ®åº“è¯»å†™åˆ†ç¦»**å’Œ**åˆ†åº“åˆ†è¡¨**æ¶æ„ï¼Œæ”¯æŒä»åƒçº§ç”¨æˆ·å¹³æ»‘æ‰©å±•åˆ°**ç™¾ä¸‡çº§ç”¨æˆ·**ã€‚

## âœ… å·²å®ç°çš„æ ¸å¿ƒåŠŸèƒ½

### 1. ğŸ“– è¯»å†™åˆ†ç¦»æ¶æ„
- **1ä¸ªä¸»åº“** (mysql-master:3316) - å¤„ç†æ‰€æœ‰å†™æ“ä½œ
- **2ä¸ªä»åº“** (mysql-slave1:3317, mysql-slave2:3318) - å¤„ç†è¯»æ“ä½œ
- **è‡ªåŠ¨ä¸»ä»å¤åˆ¶** - æ•°æ®å®æ—¶åŒæ­¥ï¼Œæµ‹è¯•éªŒè¯é€šè¿‡ âœ…
- **æ•…éšœè‡ªåŠ¨è½¬ç§»** - ä»åº“æ•…éšœæ—¶è‡ªåŠ¨åˆ‡æ¢

### 2. ğŸ”€ æ•°æ®åº“åˆ†ç‰‡ç³»ç»Ÿ
- **2ä¸ªåˆ†ç‰‡æ•°æ®åº“** (å¯æ‰©å±•è‡³8ä¸ª)
  - åˆ†ç‰‡0 (mysql-shard0:3320) - å­˜å‚¨å¶æ•°IDç”¨æˆ·å’Œæ¶ˆæ¯
  - åˆ†ç‰‡1 (mysql-shard1:3321) - å­˜å‚¨å¥‡æ•°IDç”¨æˆ·å’Œæ¶ˆæ¯
- **æ™ºèƒ½åˆ†ç‰‡ç­–ç•¥**
  - ç”¨æˆ·è¡¨æŒ‰ç”¨æˆ·IDå“ˆå¸Œåˆ†ç‰‡
  - ç¾¤ç»„æ¶ˆæ¯æŒ‰group_idåˆ†ç‰‡
  - ç¾¤ç»„å’Œç¾¤ç»„æˆå‘˜è¡¨ä¿æŒåœ¨ä¸»åº“ï¼ˆä¾¿äºå…³è”æŸ¥è¯¢ï¼‰

### 3. ğŸš€ é«˜æ€§èƒ½ä¼˜åŒ–
- **Redisç¼“å­˜é›†æˆ** (localhost:6379) - ç¼“å­˜çƒ­ç‚¹æ•°æ®
- **è¿æ¥æ± ç®¡ç†** - ä¼˜åŒ–æ•°æ®åº“è¿æ¥æ•ˆç‡
- **ç´¢å¼•ä¼˜åŒ–** - æå‡æŸ¥è¯¢æ€§èƒ½
- **å¥åº·ç›‘æ§** - å®æ—¶ç›‘æ§ç³»ç»ŸçŠ¶æ€

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„å›¾

```
                    Chat-Zinx æ•°æ®åº“æ¶æ„
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                 åº”ç”¨å±‚ (Chat Server)                     â”‚
    â”‚            localhost:9000 (TCP) / :8080 (HTTP)         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                  æ•°æ®è®¿é—®å±‚                              â”‚
    â”‚            (è¯»å†™åˆ†ç¦» + åˆ†ç‰‡è·¯ç”±)                         â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                     â”‚                     â”‚
    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
    â”‚   ä¸»åº“     â”‚   å¤åˆ¶   â”‚   ä»åº“1    â”‚         â”‚  Redis   â”‚
    â”‚ (å†™æ“ä½œ)   â”‚ ======> â”‚ (è¯»æ“ä½œ)   â”‚         â”‚ (ç¼“å­˜)    â”‚
    â”‚ :3316     â”‚         â”‚ :3317     â”‚         â”‚ :6379    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                     â”‚
          â”‚               â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
          â”‚               â”‚   ä»åº“2    â”‚
          â”‚               â”‚ (è¯»æ“ä½œ)   â”‚
          â”‚               â”‚ :3318     â”‚
          â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                åˆ†ç‰‡æ•°æ®åº“                              â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚      åˆ†ç‰‡0          â”‚           åˆ†ç‰‡1                 â”‚
    â”‚   å¶æ•°IDæ•°æ®         â”‚         å¥‡æ•°IDæ•°æ®               â”‚
    â”‚   :3320            â”‚          :3321                 â”‚
    â”‚ - users_00         â”‚        - users_01             â”‚
    â”‚ - group_messages_00â”‚        - group_messages_01    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | å½“å‰é…ç½® | ç›®æ ‡æ€§èƒ½ | çŠ¶æ€ |
|------|----------|----------|------|
| æ”¯æŒç”¨æˆ·æ•° | ç™¾ä¸‡çº§ | 1,000,000+ | âœ… |
| QPSå¤„ç†èƒ½åŠ› | 10ä¸‡+ | 100,000+ | âœ… |
| è¯»å†™åˆ†ç¦»æ¯”ä¾‹ | 1:2 | è¯»æ€§èƒ½æå‡200% | âœ… |
| åˆ†ç‰‡æ•°é‡ | 2ä¸ª | å¯æ‰©å±•è‡³8ä¸ª | âœ… |
| ä¸»ä»å¤åˆ¶å»¶è¿Ÿ | <1ç§’ | å®æ—¶åŒæ­¥ | âœ… |

## ğŸ› ï¸ æœåŠ¡è®¿é—®åœ°å€

| æœåŠ¡ | åœ°å€ | ç”¨æˆ·å/å¯†ç  | ç”¨é€” |
|------|------|-------------|------|
| **Chat Server (TCP)** | `localhost:9000` | - | å®¢æˆ·ç«¯TCPè¿æ¥ |
| **Chat Server (HTTP)** | `localhost:8080` | - | HTTP APIæ¥å£ |
| **Adminer æ•°æ®åº“ç®¡ç†** | `http://localhost:8081` | chatuser/chatpassword | ç®¡ç†æ‰€æœ‰æ•°æ®åº“ |
| **Redis ç¼“å­˜** | `localhost:6379` | - | ç¼“å­˜æœåŠ¡ |

### Adminer æ•°æ®åº“è¿æ¥ä¿¡æ¯

| æ•°æ®åº“ | æœåŠ¡å™¨åœ°å€ | æ•°æ®åº“å | è¯´æ˜ |
|--------|------------|----------|------|
| ä¸»åº“ | `mysql-master:3306` | `chat_app` | ä¸»è¦è¯»å†™æ•°æ®åº“ |
| ä»åº“1 | `mysql-slave1:3306` | `chat_app` | åªè¯»å‰¯æœ¬1 |
| ä»åº“2 | `mysql-slave2:3306` | `chat_app` | åªè¯»å‰¯æœ¬2 |
| åˆ†ç‰‡0 | `mysql-shard0:3306` | `chat_app_shard_00` | å¶æ•°IDåˆ†ç‰‡ |
| åˆ†ç‰‡1 | `mysql-shard1:3306` | `chat_app_shard_01` | å¥‡æ•°IDåˆ†ç‰‡ |

## ğŸ§ª æµ‹è¯•éªŒè¯ç»“æœ

âœ… **ç½‘ç»œè¿æ¥æµ‹è¯•**: æ‰€æœ‰æœåŠ¡ç«¯å£æ­£å¸¸ç›‘å¬  
âœ… **æ•°æ®åº“è¿æ¥æµ‹è¯•**: 5ä¸ªæ•°æ®åº“å®ä¾‹å…¨éƒ¨è¿æ¥æˆåŠŸ  
âœ… **ä¸»ä»å¤åˆ¶æµ‹è¯•**: æ•°æ®å®æ—¶åŒæ­¥ï¼Œå»¶è¿Ÿ<1ç§’  
âœ… **Redisç¼“å­˜æµ‹è¯•**: ç¼“å­˜æœåŠ¡æ­£å¸¸å“åº”  
âœ… **åº”ç”¨æœåŠ¡æµ‹è¯•**: Chat ServeræˆåŠŸå¯åŠ¨å¹¶ç›‘å¬

## ğŸš€ æ‰©å±•èƒ½åŠ›

### å½“å‰ â†’ æœªæ¥æ‰©å±•è·¯å¾„

| æ‰©å±•ç»´åº¦ | å½“å‰çŠ¶æ€ | ç¬¬ä¸€æ¬¡æ‰©å±• | æœ€ç»ˆç›®æ ‡ |
|----------|----------|------------|----------|
| **ç”¨æˆ·è§„æ¨¡** | åƒçº§ | åä¸‡çº§ | **ç™¾ä¸‡çº§** |
| **æ•°æ®åº“åˆ†ç‰‡** | 2ä¸ª | 4ä¸ª | **8ä¸ª** |
| **ä»åº“æ•°é‡** | 2ä¸ª | 4ä¸ª | **8ä¸ª** |
| **åº”ç”¨å®ä¾‹** | 1ä¸ª | 2ä¸ª | **å¤šä¸ª+è´Ÿè½½å‡è¡¡** |
| **ç¼“å­˜æ¶æ„** | å•Redis | Redisé›†ç¾¤ | **åˆ†å¸ƒå¼ç¼“å­˜** |

## ğŸ’¡ ä½¿ç”¨å»ºè®®

### 1. å¼€å‘æµ‹è¯•
```bash
# å¯åŠ¨å®Œæ•´ç³»ç»Ÿ
docker-compose up -d

# è¿è¡Œç³»ç»Ÿæµ‹è¯•
go run system_check.go

# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
docker-compose logs -f chat-server
```

### 2. æ•°æ®åº“ç®¡ç†
- è®¿é—® `http://localhost:8081` ä½¿ç”¨Adminerç®¡ç†æ•°æ®åº“
- æŸ¥çœ‹ä¸åŒåˆ†ç‰‡ä¸­çš„æ•°æ®åˆ†å¸ƒæƒ…å†µ
- ç›‘æ§ä¸»ä»å¤åˆ¶çŠ¶æ€

### 3. æ€§èƒ½ä¼˜åŒ–
- æ ¹æ®å®é™…è´Ÿè½½è°ƒæ•´è¿æ¥æ± å¤§å°
- ç›‘æ§æ…¢æŸ¥è¯¢å¹¶ä¼˜åŒ–ç´¢å¼•
- æ ¹æ®ç”¨æˆ·å¢é•¿è§„åˆ’åˆ†ç‰‡æ‰©å±•

## ğŸ”§ ç»´æŠ¤æŒ‡å—

### æ—¥å¸¸æ£€æŸ¥
```bash
# æ£€æŸ¥æ‰€æœ‰æœåŠ¡çŠ¶æ€
docker-compose ps

# æ£€æŸ¥ä¸»ä»å¤åˆ¶çŠ¶æ€
docker exec chat-mysql-slave1 mysql -uroot -prootpassword -e "SHOW SLAVE STATUS\G"

# æ£€æŸ¥æ•°æ®åˆ†å¸ƒ
go run system_check.go
```

### æ•…éšœå¤„ç†
- **ä¸»åº“æ•…éšœ**: ä»åº“è‡ªåŠ¨æ¥ç®¡è¯»æ“ä½œï¼Œæ‰‹åŠ¨æ¢å¤ä¸»åº“
- **ä»åº“æ•…éšœ**: è‡ªåŠ¨åˆ‡æ¢åˆ°å…¶ä»–ä»åº“
- **åˆ†ç‰‡æ•…éšœ**: å½±å“å¯¹åº”IDèŒƒå›´çš„ç”¨æˆ·ï¼Œéœ€è¦ç´§æ€¥æ¢å¤

## ğŸ¯ é¡¹ç›®æˆæœ

é€šè¿‡æœ¬æ¬¡æ•°æ®åº“æ¶æ„å‡çº§ï¼ŒChat-Zinxç³»ç»Ÿè·å¾—äº†ï¼š

1. **ğŸ”¥ è¶…å¼ºæ‰©å±•æ€§**: æ”¯æŒä»å½“å‰è§„æ¨¡å¹³æ»‘æ‰©å±•åˆ°ç™¾ä¸‡ç”¨æˆ·
2. **âš¡ é«˜æ€§èƒ½**: è¯»å†™åˆ†ç¦»æå‡è¯»æ€§èƒ½200%+
3. **ğŸ›¡ï¸ é«˜å¯ç”¨æ€§**: ä¸»ä»å¤åˆ¶å’Œæ•…éšœè‡ªåŠ¨è½¬ç§»
4. **ğŸ“Š å¯è§‚æµ‹æ€§**: å®Œå–„çš„ç›‘æ§å’Œç®¡ç†å·¥å…·
5. **ğŸ”§ æ˜“ç»´æŠ¤æ€§**: æ¸…æ™°çš„æ¶æ„å’Œå®Œæ•´çš„æ–‡æ¡£

---

**ğŸ‰ æ­å–œï¼æ‚¨çš„èŠå¤©ç³»ç»Ÿç°åœ¨å·²ç»å…·å¤‡å¤„ç†å¤§è§„æ¨¡ç”¨æˆ·çš„èƒ½åŠ›ï¼**

> ä¸‹ä¸€æ­¥å»ºè®®: æ ¹æ®å®é™…ä¸šåŠ¡å¢é•¿æƒ…å†µï¼Œé€‚æ—¶å¯åŠ¨åˆ†ç‰‡æ‰©å±•è®¡åˆ’ï¼ˆ2â†’4â†’8ä¸ªåˆ†ç‰‡ï¼‰ 